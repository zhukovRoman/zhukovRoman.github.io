<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <script type="application/javascript" src="jq.min.js"></script>
</head>
<body>
Участников в группе: <input type="text" id="limit" value="55000">
<button id ='go'>Поехали</button>
<textarea id = "area" rows="100" cols="100" style="float: right"></textarea>

</body>
</html>

<script type="application/javascript">
    $(document).ready(function() {
      console.log('start');
      var limit = 0;
      var users = [];
      var current = 0;
      $("#go").on('click',function(){
          limit = parseInt($("#limit").val());
          while(current<limit){
              getData(current);
              current+=1000;
          }
          setTimeout(download, 5000)

      })


        function print(){
            console.log('startprint', users)
            var area =  $('#area').val('');
            $.each(users, function(i,user){
                var string =  user.first_name+";"+user.last_name+";"+user.sex+";"+user.uid+";\n";
                area.val(area.val()+string)
            })
        }

        function download(){
            var csvContent = "data:text/csv;charset=utf-8,";
            users.forEach(function(user, index){

                dataString = user.first_name+";"+user.last_name+";"+user.sex+";"+user.uid
                csvContent += index < users.length ? dataString+ "\n" : dataString;

            });

            var encodedUri = encodeURI(csvContent);
            var link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "my_data.csv");

            link.click(); // This will download the data file named "my_data.csv".
        }

        function getData(offset){
            $.ajax({
            dataType: "jsonp",
            cors: true,
            url: "https://api.vk.com/method/groups.getMembers?group_id=smartcost&offset="+offset+"&fields=sex,age&version=5.27",
            success: function(data){
                console.log(data.response)
                $.each(data.response.users, function(i,user){
                    users.push(user);
                })
            }
        });
        }

//
    })
</script>