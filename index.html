<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="format-detection" content="telephone=no">
    <meta name="format-detection" content="address=no">
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=0.5, maximum-scale=0.5,minimum-scale=0.5, target-densitydpi=medium-dpi" />
    <title></title>
    <link rel="stylesheet" href="css/fonts/PTSans/stylesheet.css" type="text/css">
    <link rel="stylesheet" href="css/jqmobile/jquery.mobile-1.4.4.min.css" />
    <script src="js/jq.min.js"></script>
    <script src="js/jquery.mobile-1.4.4.min.js"></script>
    <script type="text/javascript" src="js/highcharts.js"></script>
    <script type="text/javascript" src="js/hc-theme.js"></script>
    <script type="text/javascript" src="js/my_common_scripts.js"></script>
    <script type="text/javascript" src="js/fastclick.js"></script>
    <script type="text/javascript" src="js/moment.js"></script>
    <script type="text/javascript" src="js/menu.js"></script>

    <link rel="stylesheet" type="text/css" href="css/filters.css">
    <link rel="stylesheet" type="text/css" href="css/common.css">

    <!--empl css-->
    <link rel="stylesheet" type="text/css" href="css/empl.css">

    <script type="text/javascript" src="js/empl.js"></script>
    <script type="text/javascript" src="js/data/empl.js"></script>

    <!--objects -->

    <link rel="stylesheet" type="text/css" href="css/objects.css">
    <link rel="stylesheet" type="text/css" href="css/object_view.css">

    <script src="http://api-maps.yandex.ru/2.0.18/?load=package.standard,package.clusters&lang=ru-RU" type="text/javascript"></script>
    <script type="text/javascript" src="js/data/objects.js"></script>
    <script type="text/javascript" src="js/objects/filter.js"></script>
    <script type="text/javascript" src="js/objects/charts.js"></script>
    <script type="text/javascript" src="js/objects/map_marker.js"></script>
    <script type="text/javascript" src="js/objects/objects_logic.js"></script>

    <script type="text/javascript" src="js/objects/obj_view.js"></script>


    <!--oranizations-->
    <link rel="stylesheet" type="text/css" href="css/organization.css">

    <script type="text/javascript" src="js/data/organizations.js"></script>
    <script type="text/javascript" src="js/organizations_logic.js"></script>


    <!--tenders-->
    <link rel="stylesheet" type="text/css" href="css/tenders.css">

    <script type="text/javascript" src="js/tenders.js"></script>
    <script type="text/javascript" src="js/data/tenders.js"></script>


    <!--sales-->
    <link rel="stylesheet" type="text/css" href="css/sales.css">

    <script type="text/javascript" src="js/highcharts-more.js"></script>
    <script type="text/javascript" src="js/sales.js"></script>
    <script type="text/javascript" src="js/my_common_scripts.js"></script>
    <script type="text/javascript" src="js/data/sales.js"></script>

    <link rel="stylesheet" type="text/css" href="css/main.css">

    <script type="text/javascript" src="js/main_page.js"></script>

</head>
<body >
<div class="status-bar" style="background-image: none "></div>
<div class="main-logo" id="main-logo" style="left: -888px"></div>
<div id="left-menu" class="transparent-menu">
    <a href="index.html" data-transition="slide" >
        <div id='logo' class="menu-picture hide_image" ></div>
    </a>
    <div id="float_background" style="display: none"></div>
    <hr class="menu-item-devider" style="display: none">
    <div class="menu">
        <a href="empl.html" data-transition="slide" data-prefetch>
            <div class="menu-item ">
                <div class="menu-picture empl-menu-picture "></div>
                <div class="menu-item-text">Кадры</div>
            </div>
        </a>
        <hr class="menu-item-devider" style="display: none">
        <a href="objects.html" data-transition="slide" data-prefetch>
            <div class="menu-item">
                <div class="menu-picture obj-menu-picture"></div>
                <div class="menu-item-text">Объекты</div>
            </div>
        </a>
        <hr class="menu-item-devider" style="display: none">
        <a href="organizations.html" data-transition="slide" data-prefetch>
            <div class="menu-item">
                <div class="menu-picture contractors-menu-picture "></div>
                <div class="menu-item-text">Подрядчики</div>
            </div>
        </a>
        <hr class="menu-item-devider" style="display: none">
        <a href="tenders.html" data-transition="slide" data-prefetch>
            <div class="menu-item ">
                <div class="menu-picture tenders-menu-picture "></div>
                <div class="menu-item-text">Конкурсы</div>
            </div>
        </a>
        <hr class="menu-item-devider" style="display: none">
        <a href="sales.html" data-transition="slide" data-prefetch>
            <div class="menu-item">
                <div class="menu-picture sales-menu-picture "></div>
                <div class="menu-item-text">Продажи</div>
            </div>
        </a>
    </div>
</div>
<div class="right-side" data-role="page" id='main_page' style="box-shadow: none">
    <div class="search-clock">
        <input type="text" id="search_field" data-role="none" placeholder="Поиск"/>
        <span id="search_cancel_button">Отменить</span>
    </div>
    <div class="search-result-bg" id="search-result-bg" style="overflow-y: scroll"></div>
    <div class="main-content">
        <div class="main-info-headers">
            <div class="main-info-header-part" style="min-height: 140px;max-height: 140px;"></div>
            <div class="main-info-header-part">
                <div class="main-info-header-part-name">
                    Кадры
                </div>
                <div class="main-info-header-part-value-name">
                    Средняя ЗП за последний месяц
                </div>
                <div class="main-info-header-part-value-name">
                    Общее число сотрудников
                </div>
                <div class="main-info-header-part-value-name">
                    Количество вакансий
                </div>
            </div>
            <div class="main-info-header-part">
                <div class="main-info-header-part-name">
                    Объекты
                </div>
                <div class="main-info-header-part-value-name">
                    Осталось оплатить/оплачено
                </div>
                <div class="main-info-header-part-value-name">
                    Число активных объектов
                </div>
                <div class="main-info-header-part-value-name">
                    % выполнения работ
                </div>
            </div>
            <div class="main-info-header-part">
                <div class="main-info-header-part-name">
                    Подрядчики
                </div>
                <div class="main-info-header-part-value-name">
                    Число активных подрядчиков <br>
                    (у которых есть хоть один объект)
                </div>

            </div>
            <div class="main-info-header-part">
                <div class="main-info-header-part-name">
                    Торги (текущий год)
                </div>
                <div class="main-info-header-part-value-name">
                    Сумма / число конкурсов
                </div>
                <div class="main-info-header-part-value-name">
                    Конкурсов с одной заявкой (от суммы)
                </div>
                <div class="main-info-header-part-value-name">
                    Средние понижение цены
                </div>
            </div>
            <div class="main-info-header-part">
                <div class="main-info-header-part-name">
                    Продажи
                </div>
                <div class="main-info-header-part-value-name">
                    Средняя стоимость м2
                </div>
                <div class="main-info-header-part-value-name">
                    Всего продано квартир
                </div>
            </div>
        </div>
        <div class="main-info-data">
            <div class="main-info-data-part" style="min-height: 140px;max-height: 140px;"></div>
            <div class="main-info-data-part">
                <div class="main-info-data-part-value" id="salary_avg"></div>
                <div class="main-info-data-part-value" id="empl_count"></div>
                <div class="main-info-data-part-value" id ="vac_count"></div>
            </div>
            <div class="main-info-data-part">
                <div class="main-info-data-part-value" id="payed_status"></div>
                <div class="main-info-data-part-value" id="active_obj_count"></div>
                <div class="main-info-data-part-value" id="work_percent"></div>
            </div>
            <div class="main-info-data-part">
                <div class="main-info-data-part-value" id="org_count"></div>
            </div>
            <div class="main-info-data-part">
                <div class="main-info-data-part-value" id="summ_count_tenders"></div>
                <div class="main-info-data-part-value" id="tenders_with_one_qty"></div>
                <div class="main-info-data-part-value" id="tenders_percent"></div>
            </div>
            <div class="main-info-data-part">
                <div class="main-info-data-part-value" id="sales_avg_m2"></div>
                <div class="main-info-data-part-value" id="sales_all_count"></div>

            </div>

        </div>

    </div>

</div>
</body>



<script type="text/javascript">

    $(function(){
        var t2 = [];
        $.each(tender_filter.getFilteredTenders(), function(i,val){
            if (val.year_finish=='2014'){
                console.log(val)
                t2.push(val);
            }
        })

        function find (id){
            var find = false
            $.each (t2, function(i,val){
                 if (val.id==id) find=true;
            })
            return find;
        }
        $.each(t2, function(i,val){
            if(!find(val.id)) console.log(val)
        })

        //menu_float_background.bindEvents();
        setTimeout(function(){
            main_logic.animateInAll();
            main_logic.fillData();
        },100)

        FastClick.attach(document.getElementById('left-menu'))
        $(document).on('pageshow', "#main_page", function (event, data) {
            main_logic.animateInAll();
            main_logic.fillData();
        });

        $(document).on('pagebeforehide', "#main_page", function (event, data) {
            main_logic.animateOutAll();
        });



        $(document).on('pagebeforeshow', "#employee", function (event, data) {
            menu_float_background.changeActiveItem('employee')
        });
        $(document).on('pageshow', "#employee", function (event, data) {
            FastClick.attach(document.getElementById('empl_tabs'))
            setTimeout(function(){empl_logic.init()}, 100)

//            menu_float_background.changeActiveItem('employee')
            // $('#empl_tabs').tabs("refresh")
        });

        $(document).on('pagebeforeshow', "#charts", function (event, data) {

            menu_float_background.changeActiveItem('charts')
        });
        $(document).on('pageshow', "#charts", function (event, data) {
            setTimeout(function(){objects_logic.bindEvents()}, 100);
//            menu_float_background.changeActiveItem('charts')
            FastClick.attach(document.getElementById('object-filter'))
            FastClick.attach(document.getElementById('list-button'))
            FastClick.attach(document.getElementById('objects-documents-tabs'))
        });

        $(document).on('pagebeforeshow', "#object_detail", function (event, data) {
            menu_float_background.changeActiveItem('charts')
        });
        $(document).on('pageshow', "#object_detail", function (event, data) {
            var url = $(this).data("url")
            setTimeout(function(){object_shower.init(url)}, 100);
        });

        $(document).on('pagebeforeshow', "#organization_page", function (event, data) {
            menu_float_background.changeActiveItem('organization_page')
        });
        $(document).on('pageshow', "#organization_page", function (event, data) {
            setTimeout(function(){organizations_logic.initList()}, 100);
            ;
//            menu_float_background.changeActiveItem('organization_page')

        });
        $(document).on('pagebeforeshow', "#org_detail", function (event, data) {
            menu_float_background.changeActiveItem('organization_page')
        });
        $(document).on('pageshow', "#org_detail", function (event, data) {
            organizations_logic.initOrganization($(this).data("url"))
        });

        $(document).on('pagebeforeshow', "#tenders", function (event, data) {

            menu_float_background.changeActiveItem('tenders')
        });
        $(document).on('pageshow', "#tenders", function (event, data) {
            setTimeout(function(){tenders_logic.init()}, 100);
            ;
//            menu_float_background.changeActiveItem('tenders')
            FastClick.attach(document.getElementById('tender-filter'))
            FastClick.attach(document.getElementById('tender-charts-tabs'))
            FastClick.attach(document.getElementById('tender-charts-tabs2'))
        });

        $(document).on('pagebeforeshow', "#sales", function (event, data) {
            menu_float_background.changeActiveItem('sales')
        });
        $(document).on('pageshow', "#sales", function (event, data) {
            setTimeout(function(){
                sales_filter.initFilter();
                sales_logic.init();}, 100);

//            menu_float_background.changeActiveItem('sales')

            FastClick.attach(document.getElementById('sales-filter'))
            FastClick.attach(document.getElementById('sales-charts-tabs'))
            FastClick.attach(document.getElementById('statuses_detail_charts_tabs'))
        });


    })


</script>
</html>